<!DOCTYPE html>
<html lang="bg">
<head>
  <!-- 
    ACCESSIBILITY FEATURES:
    - Skip-to-content link (Shift+Tab from top)
    - Keyboard navigation: Tab to navigate, Enter/Space to activate
    - Search: Type to filter, Arrow Up/Down to navigate, Enter to select, Escape to close
    - Dropdowns: Tab through menu items, Enter/Space to open, Escape to close
    - Focus indicators: 3px pink outline on all focusable elements
    - Touch targets: Minimum 48x48px on all interactive elements
    - Color contrast: 4.5:1 or higher (WCAG AA)
    - Screen reader support: ARIA roles, labels, and descriptions
  -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Пълен гид за отглеждането на дете от 1 до 3 години - развитие, хранене, сън, поведение и основни умения.">
  <meta name="keywords" content="майчинство, бременност, бебе, родителство, грижи за бебето, новородено, кърмене, здраве на детето, етапи на развитие, съвети за родители">
  <meta name="author" content="Майки.BG">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://mayki.bg/toddler/">
  <meta property="og:title" content="Дете от 1 до 3 години - Развитие и грижа">
  <meta property="og:description" content="Пълен гид за отглеждането на дете от 1 до 3 години - развитие, хранене, сън, поведение и основни умения.">
  <meta property="og:image" content="https://motherhood.bg/assets/og-image.jpg">
  <meta property="og:locale" content="bg_BG">
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://motherhood.bg/toddler/">
  <meta name="twitter:title" content="Дете от 1 до 3 години - Развитие и грижа">
  <meta name="twitter:description" content="Пълен гид за отглеждането на дете от 1 до 3 години - развитие, хранене, сън, поведение и основни умения.">
  <meta name="twitter:image" content="https://motherhood.bg/assets/og-image.jpg">
  
  <!-- Canonical URL -->
  
  <link rel="canonical" href="https://motherhood.bg/toddler/">
  
  
  <!-- Performance hints -->
  <link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
  <link rel="dns-prefetch" href="https://www.google-analytics.com">
  <!-- Resource hints for critical assets -->
  <link rel="preload" as="style" href="/styles/main.css" type="text/css">
  <link rel="preload" as="script" href="/scripts/search.js">
  <!-- Prefetch popular pages for faster navigation -->
  <link rel="prefetch" href="/newborn/">
  <link rel="prefetch" href="/pregnancy/">
  <link rel="prefetch" href="/health/">
  <link rel="prefetch" href="/nutrition/">
  <link rel="prefetch" href="/faq/">
  <link rel="prefetch" href="/fun/">
  
  
  <title>Дете от 1 до 3 години - Развитие и грижа</title>
  <meta name="description" content="Пълен гид за отглеждането на дете от 1 до 3 години - развитие, хранене, сън, поведение и основни умения.">
  
  <!-- Open Graph Social Meta -->
  <meta property="og:title" content="Дете от 1 до 3 години - Развитие и грижа">
  <meta property="og:description" content="Пълен гид за отглеждането на дете от 1 до 3 години - развитие, хранене, сън, поведение и основни умения.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="/toddler/">
  <meta property="og:image" content="/assets/og-image.jpg">
  <meta property="og:site_name" content="Майки.BG">
  <meta property="og:locale" content="bg_BG">
  
  <!-- Twitter Meta -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Дете от 1 до 3 години - Развитие и грижа">
  <meta name="twitter:description" content="Пълен гид за отглеждането на дете от 1 до 3 години - развитие, хранене, сън, поведение и основни умения.">
  <meta name="twitter:image" content="/assets/og-image.jpg">
  
  <!-- Schema.org structured data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Motherhood.bg",
    "url": "https://motherhood.bg",
    "description": "Надежден източник на информация за майчинство и родителство в България",
    "inLanguage": "bg",
    "publisher": {
      "@type": "Organization",
      "name": "Motherhood.bg",
      "logo": {
        "@type": "ImageObject",
        "url": "https://motherhood.bg/assets/logo.png"
      }
    }
  }
  </script>
  <link rel="stylesheet" href="/styles/modern.css">
  <link rel="stylesheet" href="/styles/visual-improvements.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html, body { overflow-x: hidden; }

    :root {
      --primary-color: #6366f1;
      --secondary-color: #8b5cf6;
      --accent-color: #db2777;
      --text-color: #1f2937;
      --text-light: #6b7280;
      --bg-color: #f8fafc;
      --white: #ffffff;
      --border-color: #e5e7eb;
      --shadow: 0 4px 12px rgba(0,0,0,0.08);
      --shadow-md: 0 8px 24px rgba(0,0,0,0.12);
      --shadow-lg: 0 12px 32px rgba(0,0,0,0.15);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
    }

    /* Accessibility: Skip-to-content link */
    .skip-link {
      position: absolute;
      top: -40px;
      left: 0;
      background: var(--accent-color);
      color: white;
      padding: 8px 16px;
      text-decoration: none;
      border-radius: 0 0 var(--radius-sm) 0;
      z-index: 10001;
      font-weight: 600;
      transition: top 0.3s ease;
    }

    .skip-link:focus {
      top: 0;
      outline: 3px solid white;
      outline-offset: 2px;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
      color: var(--text-color);
      background: var(--bg-color);
      line-height: 1.6;
      font-size: 16px;
      font-weight: 400;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .logo-icon {
      font-size: 2rem;
    }

    /* Mobile Menu Toggle */
    .mobile-menu-toggle {
      display: none;
      flex-direction: column;
      gap: 5px;
      background: none;
      border: none;
      cursor: pointer;
      padding: 5px;
    }

    .mobile-menu-toggle span {
      width: 25px;
      height: 3px;
      background: white;
      border-radius: 2px;
      transition: all 0.3s;
    }

    .mobile-menu-toggle.active span:nth-child(1) {
      transform: rotate(45deg) translate(8px, 6px);
    }

    .mobile-menu-toggle.active span:nth-child(2) {
      opacity: 0;
    }

    .mobile-menu-toggle.active span:nth-child(3) {
      transform: rotate(-45deg) translate(7px, -5px);
    }

    .site-header {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: #fff;
      padding: 4px 0;
      box-shadow: var(--shadow-md);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255,255,255,0.1);
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      width: 100%;
      z-index: 10000;
    }

    .news-ticker a:hover { text-decoration: underline; }
    
    .site-header::after {
      content: '';
      position: absolute;
      bottom: -3px;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--accent-color), transparent 70%);
    }
    .site-header .container {
      max-width: 100%;
      margin: 0 auto;
      padding: 0;
    }
    
    /* Navigation */
    .header-content {
      display: flex;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }
    .logo-image { height: 40px; width: auto; display: block; border-radius: 8px; }
    
    .logo {
      flex-shrink: 0;
    }
    
    .main-nav {
      flex: 1;
      display: flex;
      justify-content: flex-end;
    }

    .nav-list {
      list-style: none;
      display: flex;
      align-items: center;
      gap: 2px;
      margin: 0;
      padding: 0;
    }

    .nav-item {
      position: relative;
    }

    .nav-link {
      color: white;
      text-decoration: none;
      font-weight: 500;
      padding: 8px 8px;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 4px;
      border-radius: 5px;
      transition: background 0.3s;
      white-space: nowrap;
    }

    .nav-link:hover,
    .nav-link:active,
    .nav-link:focus {
      background: rgba(255,255,255,0.1);
      text-decoration: none;
      color: white;
    }

    .nav-link:focus-visible {
      outline: 2px solid rgba(255,255,255,0.9);
      outline-offset: 2px;
    }

    .nav-icon {
      width: 14px;
      height: 14px;
      transition: transform 0.3s;
    }

    .nav-item.has-dropdown .nav-link:hover .nav-icon {
      transform: rotate(180deg);
    }

    .arrow {
      font-size: 0.7em;
      margin-left: 5px;
    }

    /* Dropdown */
    .dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      background: white;
      min-width: 250px;
      border-radius: 8px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s;
      list-style: none;
      padding: 10px 0;
      margin-top: 5px;
      z-index: 9999;
    }

    .has-dropdown:hover .dropdown {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }
    .main-nav, .nav-list { position: relative; z-index: 10000; }
    .nav-item { position: relative; z-index: 10001; }
    .has-dropdown { position: relative; z-index: 10002; }

    .dropdown li {
      margin: 0;
    }

    .dropdown a {
      color: var(--text-color);
      padding: 12px 20px;
      display: block;
      transition: background 0.2s;
      text-decoration: none;
    }

    .dropdown a:hover {
      background: var(--bg-color);
      color: var(--primary-color);
      text-decoration: none;
    }

    /* Content */
    .content {
      max-width: 1000px;
      margin: 0 auto;
      padding: 48px 32px;
      background: white;
      min-height: calc(100vh - 300px);
      border-radius: 16px;
      margin-top: 40px;
      margin-bottom: 40px;
      box-shadow: 0 1px 8px rgba(0,0,0,0.06);
      border: 1px solid rgba(0,0,0,0.04);
    }

    main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
      background: white;
      min-height: 60vh;
      margin-top: 55px;
    }

    .hero-image {
      width: 100%;
      max-width: 100%;
      height: 400px;
      object-fit: cover;
      border-radius: 15px;
      margin-bottom: 30px;
      box-shadow: var(--shadow-hover);
    }

    /* Typography */
    h1 {
      font-size: clamp(2.25rem, 5vw, 3rem);
      color: var(--primary-color);
      margin-bottom: 24px;
      font-weight: 800;
      letter-spacing: -0.5px;
      line-height: 1.2;
    }

    h2 {
      font-size: clamp(1.75rem, 4vw, 2.25rem);
      color: #1a202c;
      margin-top: 48px;
      margin-bottom: 24px;
      border-bottom: 3px solid var(--primary-color);
      padding-bottom: 12px;
      font-weight: 700;
      letter-spacing: -0.3px;
    }

    h3 {
      font-size: clamp(1.2rem, 3vw, 1.5rem);
      color: var(--primary-color);
      margin-top: 25px;
      margin-bottom: 15px;
    }

    h4 {
      font-size: clamp(1rem, 2.5vw, 1.2rem);
      color: var(--text-color);
      margin-top: 20px;
      margin-bottom: 10px;
      font-weight: 600;
    }

    p {
      margin-bottom: 20px;
      line-height: 1.75;
      font-size: 1.05rem;
      color: #2d3748;
    }

    ul, ol {
      margin-left: 30px;
      margin-bottom: 20px;
    }

    li {
      margin-bottom: 10px;
      line-height: 1.7;
    }

    a {
      color: var(--primary-color);
      text-decoration: none;
      transition: color 0.3s;
    }

    a:hover {
      color: var(--secondary-color);
      text-decoration: underline;
    }

    /* Alerts */
    .alert {
      padding: 20px;
      border-radius: 10px;
      margin: 25px 0;
      border-left: 5px solid;
    }

    .alert-info {
      background: #ebf8ff;
      border-color: #3182ce;
      color: #2c5282;
    }

    .alert-warning {
      background: #fffbeb;
      border-color: #f59e0b;
      color: #92400e;
    }

    .alert-danger {
      background: #fef2f2;
      border-color: #dc2626;
      color: #7f1d1d;
    }

    .alert h3 {
      margin-top: 0;
      margin-bottom: 10px;
    }

    /* Cards */
    .card {
      background: white;
      border-radius: var(--radius-lg);
      padding: 28px;
      margin-bottom: 25px;
      box-shadow: var(--shadow);
      transition: all 0.3s cubic-bezier(0.23, 1, 0.320, 1);
      border: 1px solid rgba(0,0,0,0.05);
      overflow: hidden;
      position: relative;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.3s ease;
    }

    .card:hover {
      transform: translateY(-8px);
      box-shadow: var(--shadow-lg);
      border-color: var(--border-color);
    }

    .card:hover::before {
      transform: scaleX(1);
    }

    .card img {
      width: 100%;
      border-radius: var(--radius-md);
      margin-bottom: 15px;
      height: 200px;
      object-fit: cover;
      display: block;
    }

    .card h3 {
      margin-top: 0;
      margin-bottom: 12px;
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text-color);
    }

    .card p {
      color: var(--text-light);
      margin: 0 0 15px 0;
      line-height: 1.6;
    }

    .card-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 25px;
      margin: 30px 0;
    }
    
    .card-grid .card {
      width: 100%;
      margin-bottom: 0;
    }

    /* Buttons */
    .btn {
      display: inline-block;
      padding: 14px 32px;
      min-height: 48px;
      min-width: 48px;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      text-decoration: none;
      border-radius: var(--radius-lg);
      font-weight: 600;
      font-size: 1rem;
      transition: all 0.3s cubic-bezier(0.23, 1, 0.320, 1);
      border: none;
      cursor: pointer;
      text-align: center;
      box-shadow: var(--shadow-md);
      position: relative;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255,255,255,0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .btn:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-lg);
      text-decoration: none;
      color: white;
    }

    .btn:hover::before {
      width: 300px;
      height: 300px;
    }

    .btn:active {
      transform: translateY(-1px);
    }

    /* Details/Summary */
    details {
      background: var(--bg-color);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      border: 1px solid var(--border-color);
    }

    summary {
      cursor: pointer;
      font-weight: 600;
      color: var(--primary-color);
      padding: 5px;
      outline: none;
    }

    summary:hover {
      color: var(--secondary-color);
    }

    details[open] summary {
      margin-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 10px;
    }

    /* Global focus-visible for keyboard accessibility */
    a:focus-visible,
    button:focus-visible,
    input:focus-visible,
    textarea:focus-visible,
    select:focus-visible {
      outline: 3px solid var(--accent-color);
      outline-offset: 2px;
      border-radius: 4px;
    }

    /* Ensure focused dropdown items are visible */
    .dropdown a:focus-visible,
    .search-result-item:focus-visible {
      background-color: rgba(99, 102, 241, 0.15);
    }

    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      overflow-x: auto;
      display: block;
    }

    thead, tbody {
      display: table;
      width: 100%;
    }

    th, td {
      padding: 12px;
      text-align: left;
      border: 1px solid var(--border-color);
    }

    th {
      background: var(--primary-color);
      color: white;
      font-weight: 600;
    }

    tr:nth-child(even) {
      background: var(--bg-color);
    }

    /* Info Panel */
    .info-panel {
      background: linear-gradient(135deg, rgba(99,102,241,0.05) 0%, rgba(139,92,246,0.05) 100%);
      border-bottom: 1px solid rgba(99,102,241,0.1);
      padding: 14px 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
      position: relative;
      z-index: 100;
      margin-top: 72px;
    }

    .info-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .info-row {
      display: flex;
      align-items: center;
      gap: 14px;
      overflow-x: auto;
      padding: 6px 0;
      scrollbar-width: none;
    }

    .info-row::-webkit-scrollbar {
      display: none;
    }

    .info-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 14px;
      background: white;
      border-radius: var(--radius-md);
      border: 1px solid rgba(0,0,0,0.06);
      transition: all 0.3s cubic-bezier(0.23, 1, 0.320, 1);
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      white-space: nowrap;
      flex-shrink: 0;
      cursor: pointer;
      position: relative;
    }

    .info-item::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: var(--radius-md);
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      opacity: 0;
      transition: opacity 0.3s;
      z-index: -1;
    }

    .info-item:hover {
      border-color: var(--primary-color);
      box-shadow: 0 4px 12px rgba(99,102,241,0.15);
      transform: translateY(-2px);
    }

    .info-item:hover::before {
      opacity: 0.05;
    }

    .info-icon {
      width: 18px;
      height: 18px;
      min-width: 18px;
      color: var(--primary-color);
      stroke: var(--primary-color);
      flex-shrink: 0;
      transition: transform 0.3s;
    }

    .info-item:hover .info-icon {
      transform: scale(1.1);
    }

    .info-content {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .info-label {
      font-size: 0.7rem;
      color: var(--text-light);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.4px;
      line-height: 1;
    }
    }

    .info-value {
      font-size: 0.95rem;
      font-weight: 700;
      color: #1a202c;
      line-height: 1;
    }

    @media (max-width: 768px) {
      .info-panel {
        padding: 10px 0;
      }

      .info-row {
        gap: 10px;
        padding: 2px 0;
      }

      .info-item {
        padding: 6px 10px;
        border-radius: 8px;
      }

      .info-icon {
        width: 18px;
        height: 18px;
      }

      .info-label {
        font-size: 0.65rem;
      }

      .info-value {
        font-size: 0.85rem;
      }
    }

    /* Footer */
    footer {
      background: #2d3748;
      color: white;
      padding: 40px 20px 30px;
      margin-top: 60px;
    }

    footer .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    footer a {
      color: #90cdf4;
      transition: color 0.3s;
    }

    footer a:hover {
      color: white;
    }

    .footer-links {
      margin: 20px 0;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 20px;
    }

    .footer-links a {
      margin: 0;
    }

    .footer-icon {
      width: 18px;
      height: 18px;
      color: #90cdf4;
    }

    .social-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
      background: rgba(255,255,255,0.1);
      border-radius: 50%;
      color: white;
      transition: all 0.3s;
    }

    .social-icon:hover {
      background: var(--primary-color);
      color: white;
      transform: translateY(-3px);
    }

    .social-icon svg {
      width: 18px;
      height: 18px;
    }

    /* Search Functionality */
    .header-search {
      position: relative;
      flex: 1 1 350px;
      min-width: 250px;
      max-width: 600px;
      display: flex;
      align-items: center;
      margin-left: 15px;
    }

    .search-icon {
      position: absolute;
      left: 12px;
      width: 18px;
      height: 18px;
      color: #9ca3af;
      pointer-events: none;
      z-index: 10;
    }

    #site-search {
      width: 100%;
      padding: 10px 12px 10px 38px;
      border: 2px solid #e0e0e0;
      border-radius: 22px;
      font-size: 0.92rem;
      transition: all 0.3s;
      outline: none;
    }

    #site-search:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    #site-search:focus + .search-icon {
      color: var(--primary-color);
    }

    .search-results {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      max-height: 400px;
      overflow-y: auto;
      z-index: 1000;
      display: none;
      margin-top: 5px;
    }

    .search-results.active {
      display: block;
    }

    .search-result-item {
      padding: 12px 15px;
      border-bottom: 1px solid #f0f0f0;
      cursor: pointer;
      transition: background 0.2s;
    }

    .search-result-item:hover {
      background: #f8f9fa;
    }

    .search-result-item:last-child {
      border-bottom: none;
    }

    .search-result-title {
      font-weight: bold;
      color: var(--primary-color);
      margin-bottom: 3px;
    }

    .search-result-desc {
      font-size: 0.85rem;
      color: #666;
    }

    .search-no-results {
      padding: 20px;
      text-align: center;
      color: #999;
    }

    /* Mobile Responsive */
    @media (max-width: 992px) {
      .nav-list {
        gap: 2px;
      }

      .nav-link {
        padding: 8px 10px;
        font-size: 0.9rem;
      }

      .dropdown {
        min-width: 220px;
      }
    }

    @media (max-width: 768px) {
      .mobile-menu-toggle {
        display: flex;
        order: 3;
        margin-left: 5px;
      }

      .header-search {
        width: auto;
        flex: 1;
        min-width: 0;
        margin: 0 10px;
        order: 2;
      }

      #site-search {
        font-size: 0.8rem;
        padding-top: 8px;
        padding-bottom: 8px;
      }
      
      .header-content {
        flex-wrap: nowrap;
        justify-content: space-between;
        gap: 5px;
      }
      
      .logo {
        order: 1;
        flex-shrink: 0;
      }
      
      .main-nav {
        order: 4;
        width: 100%;
        margin-right: 0;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: white;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s;
      }

      .main-nav.active {
        max-height: none;
        overflow-y: auto;
      }

      .nav-list {
        flex-direction: column;
        align-items: stretch;
        padding: 10px 0;
      }

      .nav-item {
        border-bottom: 1px solid var(--border-color);
      }

      .nav-link {
        color: var(--text-color);
        padding: 15px 20px;
      }

      .has-dropdown .dropdown {
        position: static;
        opacity: 1;
        visibility: visible;
        transform: none;
        box-shadow: none;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s;
        padding: 0;
        margin: 0;
      }

      .has-dropdown.active .dropdown {
        max-height: 500px;
        padding: 10px 0;
      }

      .dropdown a {
        padding-left: 40px;
        font-size: 0.9rem;
      }

      .hero-image {
        height: 250px;
      }

      .card-grid {
        grid-template-columns: 1fr;
      }

      .content {
        margin-top: 15px;
        margin-bottom: 15px;
        padding: 25px 15px;
      }

      .footer-links {
        flex-direction: column;
        gap: 10px;
      }
    }
    
    /* Tablet - 2 колони */
    @media (min-width: 769px) and (max-width: 1024px) {
      .card-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 480px) {
      .logo-text {
        font-size: 1.2rem;
      }

      .logo-icon {
        font-size: 1.5rem;
      }
    }

    /* Inline ad wrapper (unobtrusive spacing) */
    .ad-inline {
      margin: 20px 0;
      display: block;
    }

    /* Content-level ad spacing */
    .content-ad {
      margin: 24px 0;
      display: block;
    }

    /* Cookie banner */
    .cookie-banner {
      position: fixed;
      left: 20px;
      right: 20px;
      bottom: 20px;
      z-index: 1100;
      background: white;
      border: 1px solid var(--border-color);
      border-radius: 14px;
      box-shadow: 0 12px 40px rgba(0,0,0,0.12);
      padding: 18px;
      display: none;
    }

    .cookie-inner {
      display: flex;
      gap: 16px;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    .cookie-copy h3 {
      margin: 0 0 6px 0;
      color: var(--primary-color);
      font-size: 1.05rem;
    }

    .cookie-copy p {
      margin: 0;
      color: #4a5568;
    }

    .cookie-actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .cookie-preferences {
      margin-top: 12px;
      border-top: 1px solid var(--border-color);
      padding-top: 12px;
      background: #f8f9ff;
      border-radius: 10px;
    }

    .cookie-preferences[hidden] {
      display: none;
    }

    .cookie-note {
      margin: 0 0 10px 0;
      color: #4a5568;
      font-size: 0.95rem;
    }

    .cookie-toggle {
      display: flex;
      gap: 10px;
      align-items: flex-start;
      margin: 8px 0;
    }

    .cookie-toggle input {
      margin-top: 4px;
    }

    .cookie-toggle span {
      color: #2d3748;
      line-height: 1.5;
    }

    .cookie-pref-actions {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      margin-top: 10px;
    }

    .btn-secondary {
      background: transparent;
      color: var(--primary-color);
      border: 2px solid var(--primary-color);
    }

    .btn-secondary:hover {
      background: #eef2ff;
      color: var(--secondary-color);
    }

    .btn-ghost {
      background: #f6f8ff;
      color: var(--primary-color);
      border: 1px solid #e5e7f5;
    }

    .btn-ghost:hover {
      background: #eef2ff;
      color: var(--secondary-color);
    }

    @media (max-width: 768px) {
      .cookie-banner {
        left: 10px;
        right: 10px;
        bottom: 10px;
      }

      .cookie-inner {
        flex-direction: column;
        align-items: flex-start;
      }

      .cookie-actions {
        width: 100%;
        justify-content: flex-start;
      }
    }
    /* Sticky footer ad styles (desktop only) */
    .sticky-ad{position:fixed;left:0;right:0;bottom:0;z-index:9999;background:#fff;border-top:1px solid #eee;box-shadow:0 -4px 16px rgba(0,0,0,.08);padding:8px 12px;display:flex;align-items:center;justify-content:center}
    .sticky-ad .sticky-close{position:absolute;right:8px;top:8px;border:none;background:transparent;font-size:18px;cursor:pointer;color:#666}
    @media (max-width: 991px){.sticky-ad{display:none !important}}
    /* Reserve space to reduce CLS */
    .content-ad{min-height:280px}
  </style>
  <script>
    // Mobile menu toggle
    document.addEventListener('DOMContentLoaded', function() {
      const toggle = document.querySelector('.mobile-menu-toggle');
      const nav = document.querySelector('.main-nav');
      const dropdowns = document.querySelectorAll('.has-dropdown');

      if (toggle) {
        toggle.addEventListener('click', function() {
          toggle.classList.toggle('active');
          nav.classList.toggle('active');
        });
      }

      // Mobile dropdown toggle
      if (window.innerWidth <= 768) {
        dropdowns.forEach(dropdown => {
          const link = dropdown.querySelector('.nav-link');
          link.addEventListener('click', function(e) {
            e.preventDefault();
            dropdown.classList.toggle('active');
          });
        });
      }
    });
  </script>
  <script>
    // Expose AdSense client configured in data
    window.__ADSENSE_CLIENT__ = "";
    window.__ADSENSE_ENABLED__ = false;
    window.__ADSENSE_SLOT__ = "";
  </script>
  <script>
    (function() {
      const STORAGE_KEY = 'cookie-consent';
      const defaultPrefs = { necessary: true, functional: false, analytics: false, ads: false };

      function loadPrefs() {
        try {
          const stored = localStorage.getItem(STORAGE_KEY);
          if (!stored) return { ...defaultPrefs };
          const parsed = JSON.parse(stored);
          return { ...defaultPrefs, ...parsed, necessary: true };
        } catch (e) {
          console.warn('Неуспешно зареждане на предпочитанията за бисквитки', e);
          return { ...defaultPrefs };
        }
      }

      function applyPrefs(prefs) {
        document.documentElement.dataset.consentAnalytics = prefs.analytics ? 'granted' : 'denied';
        document.documentElement.dataset.consentFunctional = prefs.functional ? 'granted' : 'denied';
        document.documentElement.dataset.consentAds = prefs.ads ? 'granted' : 'denied';
        // Пример: блокира Google Analytics, ако няма съгласие
        window['ga-disable-GA_MEASUREMENT_ID'] = !prefs.analytics;
      }

      function persistPrefs(prefs) {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(prefs));
        applyPrefs(prefs);
        document.dispatchEvent(new CustomEvent('cookie-consent-change', { detail: prefs }));
      }

      function syncToggles(banner, prefs) {
        const analyticsToggle = banner.querySelector('#consent-analytics');
        const functionalToggle = banner.querySelector('#consent-functional');
        if (analyticsToggle) analyticsToggle.checked = !!prefs.analytics;
        if (functionalToggle) functionalToggle.checked = !!prefs.functional;
      }

      function showBannerElement(banner) {
        banner.style.display = 'block';
        banner.setAttribute('aria-hidden', 'false');
      }

      function hideBannerElement(banner) {
        banner.style.display = 'none';
        banner.setAttribute('aria-hidden', 'true');
        const panel = banner.querySelector('[data-pref-panel]');
        if (panel) panel.hidden = true;
      }

      function openPrefsPanel(banner) {
        const panel = banner.querySelector('[data-pref-panel]');
        if (panel) panel.hidden = false;
      }

      function closePrefsPanel(banner) {
        const panel = banner.querySelector('[data-pref-panel]');
        if (panel) panel.hidden = true;
      }

      function saveFromToggles(banner) {
        const prefs = {
          necessary: true,
          analytics: !!(banner.querySelector('#consent-analytics') || {}).checked,
          functional: !!(banner.querySelector('#consent-functional') || {}).checked,
          ads: !!(banner.querySelector('#consent-ads') || {}).checked
        };
        persistPrefs(prefs);
        hideBannerElement(banner);
      }

      function bindBanner(banner) {
        const stored = loadPrefs();
        applyPrefs(stored);
        syncToggles(banner, stored);

        const accept = banner.querySelector('[data-consent="accept"]');
        const reject = banner.querySelector('[data-consent="reject"]');
        const settings = banner.querySelector('[data-consent="settings"]');
        const save = banner.querySelector('[data-consent="save"]');
        const cancel = banner.querySelector('[data-consent="cancel"]');

        accept?.addEventListener('click', function() {
          const prefs = { necessary: true, analytics: true, functional: true, ads: true };
          persistPrefs(prefs);
          hideBannerElement(banner);
        });

        reject?.addEventListener('click', function() {
          const prefs = { necessary: true, analytics: false, functional: false, ads: false };
          persistPrefs(prefs);
          hideBannerElement(banner);
        });

        settings?.addEventListener('click', function() {
          syncToggles(banner, loadPrefs());
          showBannerElement(banner);
          openPrefsPanel(banner);
        });

        save?.addEventListener('click', function() {
          saveFromToggles(banner);
        });

        cancel?.addEventListener('click', function() {
          closePrefsPanel(banner);
        });

        if (!localStorage.getItem(STORAGE_KEY)) {
          showBannerElement(banner);
        }
      }

      // AdSense loader
      let adsenseLoaded = false;
      function loadAdsenseLibrary() {
        if (adsenseLoaded) return;
        if (!window.__ADSENSE_ENABLED__ || !window.__ADSENSE_CLIENT__) return;
        const s = document.createElement('script');
        s.async = true;
        s.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=' + window.__ADSENSE_CLIENT__;
        s.crossOrigin = 'anonymous';
        s.onload = function(){
          adsenseLoaded = true;
          try {
            document.querySelectorAll('ins.adsbygoogle').forEach(function(el){
              (adsbygoogle = window.adsbygoogle || []).push({});
            });
          } catch(e){ console.warn('AdSense init error', e); }
          // Insert mid-article ad after library loads
          insertMidArticleAd();
        };
        document.head.appendChild(s);
      }

      function maybeInitAds(prefs) {
        if (prefs && prefs.ads) {
          loadAdsenseLibrary();
        }
      }

      document.addEventListener('cookie-consent-change', function(e){
        maybeInitAds(e.detail);
      });

      document.addEventListener('DOMContentLoaded', function() {
        const banner = document.getElementById('cookie-banner');
        if (banner) {
          bindBanner(banner);
        }
        // Initialize ads if consent already stored
        maybeInitAds(loadPrefs());
        // Attempt mid-article insertion once DOM is ready
        insertMidArticleAd();
      });

      // Dynamically insert one inline ad on long pages after the second heading
      function insertMidArticleAd() {
        try {
          if (!window.__ADSENSE_ENABLED__) return;
          const prefs = loadPrefs();
          if (!prefs.ads) return;
          const url = (window.location && window.location.pathname) || '';
          const excluded = ['/'];
          if (excluded.includes(url)) return;

          const main = document.querySelector('main');
          if (!main) return;
          const content = main.querySelector('.content') || main;
          const textLen = (content.textContent || '').trim().length;
          if (textLen < 1200) return;

          // Avoid duplicate
          if (content.querySelector('.ad-inline ins.adsbygoogle')) return;

          const headings = content.querySelectorAll('h2, h3');
          let anchor = null;
          if (headings.length >= 2) {
            anchor = headings[1];
          } else {
            const paragraphs = content.querySelectorAll('p');
            if (paragraphs.length >= 5) anchor = paragraphs[4];
          }
          if (!anchor) return;

          const wrapper = document.createElement('div');
          wrapper.className = 'ad-inline';
          const ins = document.createElement('ins');
          ins.className = 'adsbygoogle';
          ins.style.display = 'block';
          ins.setAttribute('data-ad-client', window.__ADSENSE_CLIENT__);
          if (window.__ADSENSE_SLOT__) {
            ins.setAttribute('data-ad-slot', window.__ADSENSE_SLOT__);
          }
          ins.setAttribute('data-ad-format', 'auto');
          ins.setAttribute('data-full-width-responsive', 'true');
          wrapper.appendChild(ins);
          anchor.insertAdjacentElement('afterend', wrapper);

          try { (adsbygoogle = window.adsbygoogle || []).push({}); } catch(e){}
        } catch (e) {
          console.warn('Mid-article ad insertion failed', e);
        }
      }

      window.CookieConsent = {
        load: loadPrefs,
        save(prefs) {
          const merged = { ...defaultPrefs, ...prefs, necessary: true };
          persistPrefs(merged);
          return merged;
        },
        apply: applyPrefs,
        showPreferences() {
          const banner = document.getElementById('cookie-banner');
          if (!banner) return;
          syncToggles(banner, loadPrefs());
          showBannerElement(banner);
          openPrefsPanel(banner);
        },
        hideBanner() {
          const banner = document.getElementById('cookie-banner');
          if (banner) hideBannerElement(banner);
        }
      };

      document.dispatchEvent(new Event('cookie-consent-ready'));
    })();
  </script>
    <script>
      // Sticky footer ad: show once per session on desktop, closeable
      (function(){
        function isDesktop(){ return window.matchMedia('(min-width: 992px)').matches; }
        function isHome(){ return (window.location && window.location.pathname) === '/'; }
        function initSticky(){
          var el = document.getElementById('sticky-ad');
          if (!el) return;
          try { (window.adsbygoogle = window.adsbygoogle || []).push({}); } catch(e){}
        }
        function showSticky(){
          var el = document.getElementById('sticky-ad');
          if (!el) return;
          var CAP_KEY = 'stickyAdShown';
          if (sessionStorage.getItem(CAP_KEY)) return;
          if (!isDesktop() || isHome()) return;
          el.hidden = false;
          el.setAttribute('aria-hidden','false');
          sessionStorage.setItem(CAP_KEY,'1');
          initSticky();
        }
        document.addEventListener('click', function(ev){
          var btn = ev.target && ev.target.closest && ev.target.closest('.sticky-close');
          if (btn){ var el = document.getElementById('sticky-ad'); if (el){ el.hidden = true; el.setAttribute('aria-hidden','true'); } }
        });
        document.addEventListener('cookie-consent-change', function(e){
          // Show regardless of personalized consent; NPA handled by loader
          showSticky();
        });
        // In case consent already stored
        document.addEventListener('DOMContentLoaded', function(){ showSticky(); });
      })();
    </script>
</head>
<body>
  
  <header class="site-header">
  <!-- Skip-to-content link for keyboard navigation accessibility -->
  <a href="#main-content" class="skip-link">Преди към основното съдържание</a>
  
  <div class="container">
    <div class="header-content">
      <div class="logo">
        <a href="/">
          <img src="/Mayki.bg.jpg" alt="Майчинство BG" class="logo-image">
        </a>
      </div>
      
      <button class="mobile-menu-toggle" aria-label="Меню">
        <span></span>
        <span></span>
        <span></span>
      </button>

      <nav class="main-nav" role="navigation" aria-label="Основна навигация">
        <ul class="nav-list">
          <!-- Възрасти на детето -->
          <li class="nav-item has-dropdown">
            <a href="#" class="nav-link" aria-haspopup="true" aria-expanded="false">Възрасти <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></a>
            <ul class="dropdown" role="menu">
              <li><a href="/pregnancy/">Бременност</a></li>
              <li><a href="/newborn/">Новородено (0-12м)</a></li>
              <li><a href="/toddler/">Малки деца (1-3г)</a></li>
              <li><a href="/preschool/">Предучилищна (3-6г)</a></li>
              <li><a href="/school-age/">Училищна (7-12г)</a></li>
              <li><a href="/adolescence/">Юношество (13-18г)</a></li>
            </ul>
          </li>

          <!-- Здраве и грижи -->
          <li class="nav-item has-dropdown">
            <a href="#" class="nav-link" aria-haspopup="true" aria-expanded="false">Здраве <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></a>
            <ul class="dropdown" role="menu">
              <li><a href="/health/">Общо здраве</a></li>
              <li><a href="/health/emergency-guide/">Спешен справочник</a></li>
              <li><a href="/health/developmental-milestones/">Етапи на развитие</a></li>
              <li><a href="/nutrition/">Хранене</a></li>
              <li><a href="/mental-health/">Психично здраве</a></li>
              <li><a href="/self-care/">Самогрижа</a></li>
            </ul>
          </li>

          <!-- Образование и развитие -->
          <li class="nav-item has-dropdown">
            <a href="#" class="nav-link" aria-haspopup="true" aria-expanded="false">Образование <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></a>
            <ul class="dropdown" role="menu">
              <li><a href="/education/">Образователна система</a></li>
              <li><a href="/legal/">Правни въпроси</a></li>
              <li><a href="/relationships/">Семейни отношения</a></li>
            </ul>
          </li>

          <!-- За Мама -->
          <li class="nav-item has-dropdown">
            <a href="#" class="nav-link" aria-haspopup="true" aria-expanded="false">За Мама <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></a>
            <ul class="dropdown" role="menu">
              <li><a href="/hobbies/">Хобита и релакс</a></li>
              <li><a href="/career/">Кариера и баланс</a></li>
              <li><a href="/recipes/">Рецепти за семейството</a></li>
              <li><a href="/useful-links/">Полезни връзки</a></li>
              <li><a href="/self-care/">Самогрижа</a></li>
            </ul>
          </li>

          <!-- Инструменти и ресурси -->
          <li class="nav-item has-dropdown">
            <a href="#" class="nav-link" aria-haspopup="true" aria-expanded="false">Инструменти <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></a>
            <ul class="dropdown" role="menu">
              <li><a href="/resources/">Всички ресурси</a></li>
              <li><a href="/resources/checklists/">Чеклисти</a></li>
              <li><a href="/resources/product-recommendations/">Препоръки за продукти</a></li>
              <li><a href="/gadgets/due-date/">Калкулатор за раждане</a></li>
              <li><a href="/gadgets/bmi/">BMI калкулатор</a></li>
              <li><a href="/gadgets/growth-tracker/">Проследяване на растежа</a></li>
              <li><a href="/gadgets/vaccination-schedule/">График ваксинации</a></li>
              <li><a href="/pregnancy/contraction-timer/">Таймер на контракции</a></li>
              <li><a href="/wellness/">Холистично здраве</a></li>
            </ul>
          </li>

          <!-- Забавление -->
          <li class="nav-item has-dropdown">
            <a href="#" class="nav-link" aria-haspopup="true" aria-expanded="false">Забавление <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></a>
            <ul class="dropdown" role="menu">
              <li><a href="/fun/activities/">Занимания по възрасти</a></li>
              <li><a href="/fun/stories/">Приказки и песнички</a></li>
              <li><a href="/fun/creativity/">Креативни дейности</a></li>
              <li><a href="/fun/holidays/">Празници и традиции</a></li>
              <li><a href="/fun/games/">Интерактивни игри</a></li>
              <li><a href="/fun/outdoor/">Активности на открито</a></li>
              <li><a href="/travel/">Семейни пътешествия</a></li>
            </ul>
          </li>

          <!-- За нас -->
          <li class="nav-item">
            <a href="/faq/" class="nav-link">FAQ</a>
          </li>
          <li class="nav-item">
            <a href="/about/" class="nav-link">За нас</a>
          </li>
        </ul>
      </nav>
      
      <div class="header-search">
        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <input type="text" id="site-search" placeholder="Търси в Майки.BG..." autocomplete="off">
        <div id="search-results" class="search-results"></div>
      </div>
    </div>
  </div>
</header>


  <!-- Removed climate and news subbars per request -->

  <div class="info-panel">
  <div class="info-container">
    <div class="info-row">
      <div class="info-item" id="location-item">
        <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
          <circle cx="12" cy="10" r="3"></circle>
        </svg>
        <div class="info-content">
          <div class="info-value" id="location-display">--</div>
          <div class="info-label" id="location-region">България</div>
        </div>
      </div>

      <div class="info-item" id="temp-item">
        <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2v20m0-20a4 4 0 0 0-4 4v12a4 4 0 0 0 4 4 4 4 0 0 0 4-4V6a4 4 0 0 0-4-4z"></path>
        </svg>
        <div class="info-content">
          <div class="info-value" id="temp-display">--°</div>
          <div class="info-label">Температура</div>
        </div>
      </div>

      <div class="info-item" id="humidity-item">
        <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path>
        </svg>
        <div class="info-content">
          <div class="info-value" id="humidity-display">--</div>
          <div class="info-label">Влажност</div>
        </div>
      </div>

      <div class="info-item" id="wind-item">
        <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9.59 4.59A2 2 0 1 1 11 8H2m10.59 11.41A2 2 0 1 0 14 16H2m15.73-8.27A2.5 2.5 0 1 1 19.5 12H2"></path>
        </svg>
        <div class="info-content">
          <div class="info-value" id="wind-display">--</div>
          <div class="info-label">Вятър</div>
        </div>
      </div>

      <div class="info-item" id="uv-item">
        <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="5"></circle>
          <line x1="12" y1="1" x2="12" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="23"></line>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
          <line x1="1" y1="12" x2="3" y2="12"></line>
          <line x1="21" y1="12" x2="23" y2="12"></line>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
        <div class="info-content">
          <div class="info-value" id="uv-display">--</div>
          <div class="info-label">UV Индекс</div>
        </div>
      </div>

      <div class="info-item" id="conditions-item">
        <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M23 17a5 5 0 0 0-10 0M23 7a7 7 0 0 0-14 0m14 0a5 5 0 0 0-10 0"></path>
        </svg>
        <div class="info-content">
          <div class="info-value" id="conditions-display">--</div>
          <div class="info-label">Условия</div>
        </div>
      </div>

      <div class="info-item" id="aqi-item">
        <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"></path>
          <path d="M12 9v6m-3-3h6"></path>
        </svg>
        <div class="info-content">
          <div class="info-value" id="aqi-display">--</div>
          <div class="info-label">AQI</div>
        </div>
      </div>

      <div class="info-item" id="recommendation-item">
        <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"></path>
          <text x="12" y="16" text-anchor="middle" font-size="12" font-weight="bold">i</text>
        </svg>
        <div class="info-content">
          <div class="info-value" id="recommendation-display">--</div>
          <div class="info-label">Съвет</div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// Real-time Weather & Health Data System using Open-Meteo API
(function() {
  const weatherSystem = {
    async getLocationCoordinates() {
      return new Promise((resolve) => {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            async (position) => {
              const { latitude, longitude } = position.coords;
              localStorage.setItem('userLocation', JSON.stringify({ latitude, longitude }));
              // Get city name from coordinates
              const city = await this.getCityFromCoordinates(latitude, longitude);
              resolve({ latitude, longitude, city });
            },
            () => {
              // Default to Sofia
              resolve({ latitude: 42.6977, longitude: 23.3219, city: 'София' });
            }
          );
        } else {
          resolve({ latitude: 42.6977, longitude: 23.3219, city: 'София' });
        }
      });
    },

    async getCityFromCoordinates(latitude, longitude) {
      try {
        const response = await fetch(
          `https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}`
        );
        const data = await response.json();
        return data.address?.city || data.address?.town || data.address?.village || 'Неизвестен град';
      } catch (error) {
        console.warn('Geocoding error:', error);
        return 'Локация';
      }
    },

    async getWeatherData(latitude, longitude) {
      try {
        const response = await fetch(
          `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,relative_humidity_2m,weather_code,wind_speed_10m,uv_index,weather_code&timezone=auto`
        );
        const data = await response.json();
        return data.current;
      } catch (error) {
        console.error('Weather API error:', error);
        return null;
      }
    },

    async getAirQuality(latitude, longitude) {
      try {
        // Try Open-Meteo first
        const response = await fetch(
          `https://api.open-meteo.com/v1/air-quality?latitude=${latitude}&longitude=${longitude}&current=pm2_5,pm10,o3,no2,so2`
        );
        const data = await response.json();
        
        if (data.current && data.current.pm2_5 !== null) {
          return {
            pm2_5: data.current.pm2_5,
            pm10: data.current.pm10 || 0,
            o3: data.current.o3 || 0,
            no2: data.current.no2 || 0,
            so2: data.current.so2 || 0,
            source: 'open-meteo'
          };
        }
        
        // Fallback to WAQI if Open-Meteo has no data
        return await this.getAirQualityWAQI(latitude, longitude);
      } catch (error) {
        console.warn('Open-Meteo Air Quality error:', error);
        // Try WAQI as fallback
        return await this.getAirQualityWAQI(latitude, longitude);
      }
    },

    async getAirQualityWAQI(latitude, longitude) {
      try {
        // WAQI API - requires token but provides better coverage
        const waqiToken = '00f8d4a46ed22f0e2b1f5d8c8e8e8e8e'; // Public demo token
        const response = await fetch(
          `https://api.waqi.info/feed/geo:${latitude};${longitude}/?token=${waqiToken}`
        );
        const data = await response.json();
        
        if (data.status === 'ok' && data.data) {
          return {
            pm2_5: data.data.iaqi?.pm25?.v || data.data.iaqi?.pm10?.v || 25,
            pm10: data.data.iaqi?.pm10?.v || 0,
            aqi: data.data.aqi,
            source: 'waqi'
          };
        }
        
        // Default fallback values (Good air quality)
        return {
          pm2_5: 25,
          pm10: 40,
          aqi: 65,
          source: 'default'
        };
      } catch (error) {
        console.warn('WAQI Air Quality error:', error);
        // Return default safe values
        return {
          pm2_5: 25,
          pm10: 40,
          aqi: 65,
          source: 'default'
        };
      }
    },

    getWeatherDescription(code) {
      const descriptions = {
        0: 'Ясно ☀️',
        1: 'Облачно',
        2: 'Частично облачно',
        3: 'Облачно',
        45: 'Мъгла',
        48: 'Мъгла',
        51: 'Слабо дъжд',
        53: 'Умерено дъжд',
        55: 'Силно дъжд',
        61: 'Слаб дъжд',
        63: 'Умерен дъжд',
        65: 'Силен дъжд',
        71: 'Слаб сняг',
        73: 'Умерен сняг',
        75: 'Силен сняг',
        80: 'Слаба ливада',
        81: 'Умерена ливада',
        82: 'Силна ливада',
        85: 'Слаб снежна ливада',
        86: 'Силна снежна ливада',
        95: 'Гръмотевична буря'
      };
      return descriptions[code] || 'Неизвестно';
    },

    getUVRecommendation(uv) {
      if (uv < 3) return '✓ Безопасно';
      if (uv < 6) return '⚠️ Слънцезащита';
      if (uv < 8) return '⚠️ Висока защита';
      if (uv < 11) return '🔴 Избегнете';
      return '🔴 Критично';
    },

    getAQILevel(pm25) {
      if (pm25 <= 12) return '✅ Отличен';
      if (pm25 <= 35.4) return '🟢 Добър';
      if (pm25 <= 55.4) return '🟡 Умерен';
      if (pm25 <= 150.4) return '🟠 Лош';
      if (pm25 <= 250.4) return '🔴 Много лош';
      return '⛔ Опасен';
    },

    async init() {
      const location = await this.getLocationCoordinates();
      const weather = await this.getWeatherData(location.latitude, location.longitude);
      const aqi = await this.getAirQuality(location.latitude, location.longitude);

      if (weather) {
        // Location - Display city name instead of Bulgaria
        const cityDisplay = location.city || 'Локация';
        document.getElementById('location-display').textContent = cityDisplay;
        document.getElementById('location-region').textContent = 'Текущо място';

        // Temperature
        document.getElementById('temp-display').textContent = Math.round(weather.temperature_2m) + '°C';

        // Humidity
        document.getElementById('humidity-display').textContent = weather.relative_humidity_2m + '%';

        // Wind
        document.getElementById('wind-display').textContent = Math.round(weather.wind_speed_10m) + ' км/ч';

        // UV Index
        document.getElementById('uv-display').textContent = Math.round(weather.uv_index);

        // Weather Conditions
        document.getElementById('conditions-display').textContent = this.getWeatherDescription(weather.weather_code);

        // Air Quality Index (PM2.5 based)
        if (aqi && (aqi.pm2_5 !== null && aqi.pm2_5 !== undefined)) {
          const aqiLevel = this.getAQILevel(aqi.pm2_5);
          document.getElementById('aqi-display').textContent = aqiLevel;
          
          // Color code based on air quality
          const aqiItem = document.getElementById('aqi-item');
          if (aqi.pm2_5 <= 12) {
            aqiItem.style.borderBottomColor = '#10b981';
          } else if (aqi.pm2_5 <= 35.4) {
            aqiItem.style.borderBottomColor = '#84cc16';
          } else if (aqi.pm2_5 <= 55.4) {
            aqiItem.style.borderBottomColor = '#f59e0b';
          } else if (aqi.pm2_5 <= 150.4) {
            aqiItem.style.borderBottomColor = '#ef4444';
          } else {
            aqiItem.style.borderBottomColor = '#7f1d1d';
          }
        } else {
          // Fallback display
          document.getElementById('aqi-display').textContent = '🟢 Добър';
          document.getElementById('aqi-item').style.borderBottomColor = '#84cc16';
        }

        // Recommendation based on UV
        const recommendation = this.getUVRecommendation(weather.uv_index);
        document.getElementById('recommendation-display').textContent = recommendation;
      }
    }
  };

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => weatherSystem.init());
  } else {
    weatherSystem.init();
  }
})();
</script>




  <div id="cookie-banner" class="cookie-banner" aria-hidden="true">
  <div class="cookie-inner">
    <div class="cookie-copy">
      <h3>Бисквитки за по-добро изживяване</h3>
      <p>Използваме бисквитки, за да работи сайтът надеждно, да помним предпочитанията ви и да събираме анонимна статистика. Научете повече в <a href="/cookies/">политиката за бисквитки</a>.</p>
    </div>
    <div class="cookie-actions">
      <button class="btn btn-ghost" type="button" data-consent="reject">Само необходимите</button>
      <button class="btn btn-secondary" type="button" data-consent="settings">Настройки</button>
      <button class="btn" type="button" data-consent="accept">Приемам всички</button>
    </div>
  </div>

  <div class="cookie-preferences" data-pref-panel hidden>
    <p class="cookie-note">Изберете какво да разрешите. Можете да промените избора си по всяко време от тази страница.</p>

    <label class="cookie-toggle">
      <input type="checkbox" checked disabled>
      <span><strong>Задължителни</strong> — нужни за работа на сайта (сигурност, базова функционалност).</span>
    </label>

    <label class="cookie-toggle">
      <input type="checkbox" id="consent-functional">
      <span><strong>Функционални</strong> — запомнят предпочитания като език и настройки.</span>
    </label>

    <label class="cookie-toggle">
      <input type="checkbox" id="consent-analytics">
      <span><strong>Аналитични</strong> — анонимна статистика за подобряване на съдържанието.</span>
    </label>

    <label class="cookie-toggle">
      <input type="checkbox" id="consent-ads">
      <span><strong>Рекламни</strong> — при съгласие: персонализирани реклами; при отказ: може да се показват неперсонализирани (без таргетиране) реклами чрез AdSense.</span>
    </label>

    <div class="cookie-pref-actions">
      <button class="btn btn-secondary" type="button" data-consent="cancel">Отказ</button>
      <button class="btn" type="button" data-consent="save">Запази избора</button>
    </div>
  </div>
</div>


  <main id="main-content" style="padding-top: 80px;">
    <div class="content">
  <img class="hero-image" src="/assets/images/hero-toddler-new.jpg" alt="Дете на 1-3 години" />
  <h1>Дете от 1 до 3 години</h1>
  <div class="alert alert-info">
    <p>Периодът от 1 до 3 години е време на бързо развитие, откриване на света и формиране на личността. Вашето дете преминава от бебе към самостоятелно малко човече!</p>
  </div>
  <h2>Развитие по възраст</h2>
  <div class="card-grid">
    <div class="card">
      <img src="/assets/images/topic-1year-old.jpg" alt="Едногодишно дете" />
      <h3>12-18 месеца</h3>
      <p>Първите стъпки и думи - вълнуващо време!</p>
      <ul>
        <li><strong>Движение:</strong> Започва да ходи самостоятелно, качва се по стълби</li>
        <li><strong>Речева:</strong> Казва 3-10 прости думи, разбира повече, отколкото говори</li>
        <li><strong>Социално:</strong> Играе до други деца, но не с тях</li>
        <li><strong>Когнитивно:</strong> Търси скрити предмети, имитира действия</li>
        <li><strong>Фина моторика:</strong> Строи кула от 2-3 кубчета, драска с молив</li>
      </ul>
    </div>
    <div class="card">
      <img src="/assets/images/topic-18months-old.jpg" alt="18 месеца" />
      <h3>18-24 месеца</h3>
      <p>Независимостта се развива - "Аз сам!"</p>
      <ul>
        <li><strong>Движение:</strong> Тича, рита топка, започва да скача</li>
        <li><strong>Речева:</strong> 50+ думи, започва да съчетава 2 думи</li>
        <li><strong>Социално:</strong> Първи признаци на непослушание, тестване на граници</li>
        <li><strong>Самообслужване:</strong> Опитва се да се храни само, пие от чаша</li>
        <li><strong>Играта:</strong> Символична игра (хранене на кукла)</li>
      </ul>
    </div>
    <div class="card">
      <img src="/assets/images/topic-2year-old.jpg" alt="Двегодишно дете" />
      <h3>2-3 години</h3>
      <p>Разцвет на езика и самостоятелността</p>
      <ul>
        <li><strong>Движение:</strong> Скача с два крака, яхне триколка, балансира</li>
        <li><strong>Речева:</strong> 200+ думи, прави изречения от 3-4 думи</li>
        <li><strong>Социално:</strong> Започва да си играе с други деца, споделя (понякога)</li>
        <li><strong>Самостоятелност:</strong> Обличане на прости дрехи, миене на ръце</li>
        <li><strong>Емоции:</strong> По-добър контрол, но все още има избухвания</li>
      </ul>
    </div>
  </div>
  <h2>Хранене</h2>
  <div class="card">
    <h3>Здравословно меню</h3>
    <p>В тази възраст детето се храни като останалите членове на семейството:</p>
    <ul>
      <li><strong>3 основни хранения + 2-3 закуски</strong></li>
      <li><strong>Млечни продукти:</strong> 2-3 порции дневно (мляко, кисело мляко, сирене)</li>
      <li><strong>Плодове и зеленчуци:</strong> Всяко хранене, разнообразие от цветове</li>
      <li><strong>Протеини:</strong> Месо, риба, яйца, бобови</li>
      <li><strong>Пълнозърнести:</strong> Хляб, паста, ориз, овесени ядки</li>
      <li><strong>Избягвайте:</strong> Твърде солена, сладка храна, опасност от задавяне</li>
    </ul>
  </div>
  <div class="alert alert-warning">
    <h3>⚠️ Често срещани проблеми с храненето</h3>
    <ul>
      <li><strong>Капризност с храната:</strong> Нормално в тази възраст! Предлагайте, но не налагайте</li>
      <li><strong>Отказ от храна:</strong> Апетитът варира, не паникьосвайте</li>
      <li><strong>Искане само на любими храни:</strong> Продължавайте да предлагате разнообразие</li>
      <li><strong>Разсейване:</strong> Хапвайте на спокойно място, без телевизор/таблет</li>
    </ul>
  </div>
  <h2>Сън</h2>
  <div class="card">
    <h3>Режим на сън</h3>
    <ul>
      <li><strong>12-18 месеца:</strong> 11-14 часа (включително 1-2 дневни съня)</li>
      <li><strong>18-24 месеца:</strong> 11-14 часа (1 дневен сън 1-3 часа)</li>
      <li><strong>2-3 години:</strong> 10-13 часа (1 дневен сън или тих час)</li>
    </ul>
<p><h4>Съвети за добър сън:</h4>
<ul>
<li>Постоянна рутина преди лягане (баня, приказка, песничка)</li>
<li>Лягане и ставане по едно и също време</li>
<li>Спокойна среда - тъмно, тихо, приятна температура</li>
<li>Любима играчка или одеяло за сигурност</li>
<li>Избягвайте екрани 1-2 часа преди сън</li>
</ul></p>
  </div>
  <h2>Приучаване към гърне</h2>
  <div class="card">
    <img src="/assets/images/topic-potty.jpg" alt="Приучаване към гърне" />
    <h3>🚽 Кога и как</h3>
    <p>Повечето деца са готови между 18 и 30 месеца. Признаци на готовност:</p>
    <ul>
      <li>Остава сухо за 2 часа</li>
      <li>Разбира и изпълнява прости инструкции</li>
      <li>Показва интерес към гърнето</li>
      <li>Може да сваля и вдига панталони</li>
      <li>Казва, когато пелената е мокра</li>
    </ul>
<p><h4>Стъпки към успеха:</h4>
<ol>
<li>Закупете удобно гърне или адаптор за тоалетна</li>
<li>Оставете детето да седне на гърнето (дори облечено) да се свикне</li>
<li>Насрочете редовни почивки на гърнето (след хранене, преди сън)</li>
<li>Похвалете успехите, не наказвайте за инциденти</li>
<li>Бъдете търпеливи - отнема седмици/месеци</li>
</ol></p>
  </div>
  <h2>Поведение и дисциплина</h2>
  <div class="card">
    <h3>Справяне с предизвикателства</h3>
    <p>Това е възрастта на "ужасните двойки" - период на непослушание и тестване на граници.</p>
<p><h4>Здрави стратегии:</h4>
<ul>
<li><strong>Ясни граници:</strong> Малко, последователни правила</li>
<li><strong>Позитивно внимание:</strong> Похвалете доброто поведение</li>
<li><strong>Избор:</strong> &quot;Искаш ли синята или червената риза?&quot;</li>
<li><strong>Пренасочване:</strong> Отклонете вниманието от нежеланото</li>
<li><strong>Тайм аут:</strong> Кратка почивка в спокойно място (1 мин на година)</li>
<li><strong>Модел:</strong> Показвайте поведението, което искате</li>
<li><strong>Емпатия:</strong> Признайте чувствата, но поставете граници</li>
</ul></p>
  </div>
  <h2>Играта и обучението</h2>
  <div class="card">
    <h3>Как децата се учат чрез игра</h3>
    <ul>
      <li><strong>Имитационна игра:</strong> Готвене, грижа за бебе, разговори по телефона</li>
      <li><strong>Конструиране:</strong> Кубчета, лего, пъзели</li>
      <li><strong>Творчество:</strong> Рисуване, моделиране, музика</li>
      <li><strong>Физическа активност:</strong> Паркове, топки, триколки</li>
      <li><strong>Книги:</strong> Четете заедно всеки ден</li>
      <li><strong>Социализация:</strong> Игра с други деца (под наблюдение)</li>
    </ul>
  </div>
  <h2>Безопасност</h2>
  <div class="alert alert-danger">
    <h3>🚨 Важни мерки за безопасност</h3>
    <ul>
      <li>Детето НИКОГА не трябва да остава само във вана</li>
      <li>Използвайте детско столче в колата (задължително!)</li>
      <li>Защитете контакти, заключете шкафове с опасни вещи</li>
      <li>Дръжте малки предмети извън достъп (опасност от задавяне)</li>
      <li>Нагледайте при хранене (риск от задавяне)</li>
      <li>Заключете медикаменти и химикали</li>
      <li>Защитете прозорци и балкони</li>
      <li>Нагледайте при игра с животни</li>
    </ul>
  </div>
  <h2>Често задавани въпроси</h2>
  <details>
    <summary><strong>Детето ми има избухвания - нормално ли е?</strong></summary>
    <p>Да, избухванията (tantrums) са абсолютно нормална част от развитието между 1 и 3 години. Децата все още не могат да контролират емоциите си и да изразят нуждите си с думи. Бъдете спокойни, поставете граници, но покажете разбиране за чувствата им.</p>
  </details>
  <details>
    <summary><strong>Детето ми не говори много - трябва ли да се притеснявам?</strong></summary>
    <p>Развитието на речта варира значително. Ако на 18 месеца детето не казва никакви думи или на 2 години не съчетава 2 думи, консултирайте педиатър. Но помнете - момчетата често говорят по-късно от момичетата, а двуезичните деца също могат да започнат по-късно.</p>
  </details>
  <details>
    <summary><strong>Кога трябва да престана да кърмя?</strong></summary>
    <p>СЗО препоръчва кърмене до 2 години и повече, ако майката и детето искат. Няма "правилна" възраст за спиране - решете според нуждите на вашето семейство. Ако искате да спрете, правете го постепенно.</p>
  </details>
  <h2>👶 Детски центрове и магазини наблизо</h2>
  <div class="alert alert-info">
    <p>Намерете детски градини, магазини за детски продукти и центрове за развитие в района си.</p>
  </div>
  <!-- Map Legend + Filters -->
  <div style="background: #f8f9fa; border-radius: 8px; padding: 15px; margin-bottom: 15px; border: 1px solid #e9ecef;">
    <h4 style="margin-top: 0; margin-bottom: 10px;">Легенда и филтри:</h4>
    <div id="tdLegend" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 10px; font-size: 0.9rem;">
      <div style="display:flex;align-items:center;gap:8px;"><div style="width:14px;height:14px;border-radius:50%;background:#ef4444;border:3px solid #fff;box-shadow:0 0 6px rgba(239,68,68,0.7);"></div><strong>Вие сте тук</strong></div>
      <label style="display:flex;align-items:center;gap:8px"><input type="checkbox" data-cat="kindergarten" checked> 🏫 <strong style="color:#f59e0b">Детски градини</strong> <span id="td-count-kindergarten" style="margin-left:auto;color:#6b7280">0</span></label>
      <label style="display:flex;align-items:center;gap:8px"><input type="checkbox" data-cat="baby_goods" checked> 👶 <strong style="color:#f97316">Магазини за бебета</strong> <span id="td-count-baby_goods" style="margin-left:auto;color:#6b7280">0</span></label>
      <label style="display:flex;align-items:center;gap:8px"><input type="checkbox" data-cat="toys" checked> 🧸 <strong style="color:#9333ea">Магазини за играчки</strong> <span id="td-count-toys" style="margin-left:auto;color:#6b7280">0</span></label>
      <label style="display:flex;align-items:center;gap:8px"><input type="checkbox" data-cat="community_centre" checked> 🍼 <strong style="color:#3b82f6">Детски центрове</strong> <span id="td-count-community_centre" style="margin-left:auto;color:#6b7280">0</span></label>
      <label style="display:flex;align-items:center;gap:8px"><input type="checkbox" data-cat="sports" checked> ⚽ <strong style="color:#22c55e">Спортни центрове</strong> <span id="td-count-sports" style="margin-left:auto;color:#6b7280">0</span></label>
    </div>
  </div>
  <div id="toddlerMap" style="height: 500px; width: 100%; margin: 20px 0; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"></div>
  <script>
// External search uses only Nominatim (free)
const searchGooglePlaces = (lat, lng, searchTerms) => {
  const bboxSize = 0.18;
  const bbox = `${lng - bboxSize},${lat - bboxSize},${lng + bboxSize},${lat + bboxSize}`;
  const termToTags = (t) => {
    const s = t.toLowerCase();
    if (s.includes('детска градина')) return { amenity: 'kindergarten' };
    if (s.includes('бебе')) return { shop: 'baby_goods' };
    if (s.includes('играчка')) return { shop: 'toys' };
    if (s.includes('детски център')) return { amenity: 'community_centre' };
    if (s.includes('спорт')) return { leisure: 'sports_centre' };
    return {};
  };
  const requests = (searchTerms || []).map(term => {
    const url = `https://nominatim.openstreetmap.org/search?format=json&limit=30&q=${encodeURIComponent(term)}&viewbox=${bbox}&bounded=1`;
    return fetch(url, { headers: { 'Accept-Language': 'bg,en', 'User-Agent': 'Motherhood-Site/1.0' } })
      .then(r => r.json())
      .then(items => (items || []).map(it => ({
        lat: parseFloat(it.lat),
        lon: parseFloat(it.lon),
        center: { lat: parseFloat(it.lat), lon: parseFloat(it.lon) },
        tags: { name: it.display_name.split(',')[0].trim(), ...termToTags(term) },
        osm_id: it.osm_id,
        osm_type: it.osm_type
      })))
      .catch(() => []);
  });
  return Promise.all(requests).then(all => all.flat());
};

const deduplicateResults = (results) => {
  const seen = new Set();
  return results.filter(item => {
    const lat = item.lat || (item.center && item.center.lat);
    const lon = item.lon || (item.center && item.center.lon);
    if (!lat || !lon) return false;
    const key = `${lat.toFixed(4)},${lon.toFixed(4)}`;
    if (seen.has(key)) return false;
    seen.add(key);
    return true;
  });
};

let toddlerMap;
let tdLayers;
let tdCounts = { kindergarten:0, baby_goods:0, toys:0, community_centre:0, sports:0 };

function tdInitLayers(map){
  tdLayers = {
    kindergarten: L.layerGroup().addTo(map),
    baby_goods: L.layerGroup().addTo(map),
    toys: L.layerGroup().addTo(map),
    community_centre: L.layerGroup().addTo(map),
    sports: L.layerGroup().addTo(map)
  };
}

function tdUpdateCounts(){
  document.getElementById('td-count-kindergarten').textContent = tdCounts.kindergarten;
  document.getElementById('td-count-baby_goods').textContent = tdCounts.baby_goods;
  document.getElementById('td-count-toys').textContent = tdCounts.toys;
  document.getElementById('td-count-community_centre').textContent = tdCounts.community_centre;
  document.getElementById('td-count-sports').textContent = tdCounts.sports;
}

function tdWireLegend(){
  const legend = document.getElementById('tdLegend');
  legend.querySelectorAll('input[type="checkbox"]').forEach(cb => {
    cb.addEventListener('change', () => {
      const cat = cb.getAttribute('data-cat');
      if (cb.checked) {
        tdLayers[cat].addTo(toddlerMap);
      } else {
        toddlerMap.removeLayer(tdLayers[cat]);
      }
    });
  });
}

function initToddlerMap() {
  const initTiles = (map) => {
    L.tileLayer('https://{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png', {
      attribution: '© OpenStreetMap contributors',
      maxZoom: 18
    }).addTo(map);
  };

  const addUserMarker = (map, lat, lon) => {
    L.circleMarker([lat, lon], {
      radius: 12,
      fillColor: '#ef4444',
      color: '#fff',
      weight: 4,
      opacity: 1,
      fillOpacity: 1
    }).addTo(map).bindPopup('<strong style="color:#ef4444;">📍 Вие сте тук</strong>');
  };

  const fetchPOIs = (lat, lon) => {
    const q = `
      [out:json][timeout:30];
      (
        nwr["amenity"="kindergarten"](around:15000,${lat},${lon});
        nwr["amenity"="childcare"](around:15000,${lat},${lon});
        nwr["amenity"="preschool"](around:15000,${lat},${lon});
        nwr["name:bg"~"детска градина|детски град"](around:16500,${lat},${lon});
        nwr["shop"="baby_goods"](around:15000,${lat},${lon});
        nwr["shop"="baby"](around:15000,${lat},${lon});
        nwr["shop"="children"](around:15000,${lat},${lon});
        nwr["name:bg"~"магазин за бебета|бебешки"](around:16500,${lat},${lon});
        nwr["shop"="toys"](around:15000,${lat},${lon});
        nwr["shop"="games"](around:15000,${lat},${lon});
        nwr["name:bg"~"играчки|игра"](around:16500,${lat},${lon});
        nwr["amenity"="community_centre"](around:15000,${lat},${lon});
        nwr["amenity"="social_facility"](around:15000,${lat},${lon});
        nwr["name:bg"~"детски център"](around:16500,${lat},${lon});
        nwr["leisure"="playground"](around:15000,${lat},${lon});
        nwr["leisure"="sports_centre"](around:15000,${lat},${lon});
        nwr["sport"](around:15000,${lat},${lon});
        nwr["leisure"="fitness_centre"](around:15000,${lat},${lon});
        nwr["leisure"="swimming_pool"](around:15000,${lat},${lon});
        nwr["name:bg"~"спорт|спортен|фитнес|басейн"](around:16500,${lat},${lon});
      );
      out center;
    `;
    
    const fetchFoursquare = async () => {
      try {
        const categories = '12058,12059,13003,13032,13033,13035,13065,18021,18062';
        const url = `https://api.foursquare.com/v3/places/search?ll=${lat},${lon}&radius=8000&categories=${categories}&limit=50`;
        const response = await fetch(url, {
          headers: { 'Accept': 'application/json', 'Authorization': 'fsq3X8VxH9vN5qK2mB4tL6wP7rD1jG3sF9cY0aZ8eR5hT2iU' }
        });
        if (!response.ok) return [];
        const data = await response.json();
        return (data.results || []).map(p => ({
          lat: p.geocodes?.main?.latitude,
          lon: p.geocodes?.main?.longitude,
          tags: { name: p.name, amenity: p.categories?.[0]?.name?.toLowerCase().includes('kindergarten') ? 'kindergarten' : 'shop' }
        }));
      } catch (e) { return []; }
    };
    
    const searchTermsArray = ['детски градини', 'магазини за бебета', 'играчки', 'детски центрове', 'спортни центрове', 'детска градина', 'ясла', 'бебешки магазин', 'детски дрехи', 'детска площадка', 'басейн за деца', 'спортен клуб за деца'];
    return Promise.all([
      fetch('https://overpass-api.de/api/interpreter', { method: 'POST', body: q })
        .then(r => r.json())
        .then(data => data.elements || []),
      searchGooglePlaces(lat, lon, searchTermsArray)
    ]).then(([overpassData, googleData]) => {
      const allResults = [...overpassData, ...googleData];
      const dedupResults = deduplicateResults(allResults);
      return { elements: dedupResults };
    }).catch(err => {
      console.log('Error loading map:', err);
      return { elements: [] };
    });
  };

  const iconFor = (tags) => {
    if (tags.amenity === 'kindergarten') return '/assets/markers/marker-orange.png';
    if (tags.shop === 'baby_goods') return '/assets/markers/marker-red.png';
    if (tags.shop === 'toys') return '/assets/markers/marker-violet.png';
    if (tags.amenity === 'community_centre') return '/assets/markers/marker-blue.png';
    if (tags.leisure === 'sports_centre') return '/assets/markers/marker-green.png';
    return '/assets/markers/marker-blue.png';
  };

  const labelFor = (tags) => {
    if (tags.amenity === 'kindergarten') return '🏫 Детска градина';
    if (tags.shop === 'baby_goods') return '👶 Магазин за бебета';
    if (tags.shop === 'toys') return '🧸 Магазин за играчки';
    if (tags.amenity === 'community_centre') return '🍼 Детски център';
    if (tags.leisure === 'sports_centre') return '⚽ Спортен център';
    return 'Локация';
  };

  const popupFor = (tags, name) => {
    const phone = tags.phone ? `📞 ${tags.phone}<br>` : '';
    const website = tags.website ? `<a href="${tags.website}" target="_blank">🌐 Вебсайт</a><br>` : '';
    return `<strong>${labelFor(tags)}</strong><br>${name}<br>${phone}${website}`;
  };

  const categorize = (tags) => {
    if (tags.amenity === 'kindergarten') return 'kindergarten';
    if (tags.shop === 'baby_goods') return 'baby_goods';
    if (tags.shop === 'toys') return 'toys';
    if (tags.amenity === 'community_centre') return 'community_centre';
    if (tags.leisure === 'sports_centre') return 'sports';
    return null;
  };

  const placeMarkers = (map, data) => {
    let placed = 0;
    data.elements.forEach(el => {
      const lat = el.lat || (el.center && el.center.lat);
      const lon = el.lon || (el.center && el.center.lon);
      if (!lat || !lon) return;
      const cat = categorize(el.tags || {});
      if (!cat) return;
      const name = (el.tags && el.tags.name) || 'Без име';
      const icon = L.icon({
        iconUrl: iconFor(el.tags || {}),
        iconSize: [25, 41],
        iconAnchor: [12, 41]
      });
      const m = L.marker([lat, lon], {icon}).bindPopup(popupFor(el.tags || {}, name));
      m.addTo(tdLayers[cat]);
      tdCounts[cat]++;
      placed++;
    });
    tdUpdateCounts();
    if (placed === 0){
      L.popup().setLatLng(map.getCenter()).setContent('Няма намерени места наблизо.').openOn(map);
    }
  };

  const onGeoSuccess = (pos) => {
    const lat = pos.coords.latitude;
    const lon = pos.coords.longitude;
    toddlerMap = L.map('toddlerMap').setView([lat, lon], 13);
    initTiles(toddlerMap);
    tdInitLayers(toddlerMap);
    tdWireLegend();
    addUserMarker(toddlerMap, lat, lon);
    fetchPOIs(lat, lon)
      .then(d => placeMarkers(toddlerMap, d))
      .catch(err => {
        console.error('Грешка:', err);
        L.popup().setLatLng(toddlerMap.getCenter()).setContent('Грешка при зареждане на данни.').openOn(toddlerMap);
      });
  };

  const initFallback = () => {
    const lat = 42.6977, lon = 23.3219;
    toddlerMap = L.map('toddlerMap').setView([lat, lon], 12);
    initTiles(toddlerMap);
    tdInitLayers(toddlerMap);
    tdWireLegend();
    fetchPOIs(lat, lon)
      .then(d => placeMarkers(toddlerMap, d))
      .catch(err => {
        console.error('Грешка:', err);
        L.popup().setLatLng(toddlerMap.getCenter()).setContent('Грешка при зареждане на данни.').openOn(toddlerMap);
      });
  };

  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(onGeoSuccess, initFallback);
  } else {
    initFallback();
  }
}

if (typeof L === 'undefined') {
  const link = document.createElement('link');
  link.rel = 'stylesheet';
  link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';
  document.head.appendChild(link);
  const script = document.createElement('script');
  script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';
  script.onload = initToddlerMap;
  document.body.appendChild(script);
} else {
  initToddlerMap();
}
  </script>
</div>


    
    
  </main>

  <footer>
  <div class="container">
    <div class="grid-3">
      <div>
        <h3>За Майчинство BG</h3>
        <p>Майчинство BG е ресурс за родители в България. Предоставяме надеждна информация за грижи за бебета и деца от раждането до юношеската възраст - здраве, хранене, развитие и много повече.</p>
      </div>
      <div>
        <h3>Полезни връзки</h3>
        <ul style="list-style:none;padding:0;">
          <li><a href="/about/">За нас</a></li>
          <li><a href="/privacy/">Поверителност</a></li>
          <li><a href="/cookies/">Бисквитки</a></li>
          <li><a href="/resources/">Ресурси</a></li>
        </ul>
      </div>
      <div>
        <h3>Свържете се с нас</h3>
        <div style="display: flex; align-items: center; gap: 8px; margin: 8px 0;">
          <svg class="footer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
            <polyline points="22,6 12,13 2,6"></polyline>
          </svg>
          <span>info@majchinstvo.bg</span>
        </div>
        <div style="display: flex; align-items: center; gap: 8px; margin: 8px 0;">
          <svg class="footer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
          </svg>
          <span>+359 888 123 456</span>
        </div>
        <p style="margin-top:1rem;">Намерете ни в социалните мрежи</p>
        <div style="display: flex; gap: 12px; margin-top: 0.5rem;">
          <a href="#" title="Facebook" class="social-icon">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path>
            </svg>
          </a>
          <a href="#" title="Instagram" class="social-icon">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.894 13.5c0 2.482-2.012 4.494-4.494 4.494s-4.494-2.012-4.494-4.494 2.012-4.494 4.494-4.494 4.494 2.012 4.494 4.494zm-8.988-4.494c-2.482 0-4.494 2.012-4.494 4.494s2.012 4.494 4.494 4.494 4.494-2.012 4.494-4.494-2.012-4.494-4.494-4.494zm7.19-4.191c.367 0 .667.3.667.667s-.3.667-.667.667-.667-.3-.667-.667.3-.667.667-.667zm2.802 4.894c0 1.241-1.006 2.247-2.247 2.247-1.241 0-2.247-1.006-2.247-2.247 0-1.241 1.006-2.247 2.247-2.247 1.241 0 2.247 1.006 2.247 2.247zM12 3.667c2.495 0 2.793.01 3.776.054.972.045 1.498.206 1.848.342.464.179.795.392 1.143.74.348.348.561.679.74 1.143.136.35.297.876.342 1.848.045.983.054 1.281.054 3.776s-.01 2.793-.054 3.776c-.045.972-.206 1.498-.342 1.848-.179.464-.392.795-.74 1.143-.348.348-.679.561-1.143.74-.35.136-.876.297-1.848.342-.983.045-1.281.054-3.776.054s-2.793-.01-3.776-.054c-.972-.045-1.498-.206-1.848-.342-.464-.179-.795-.392-1.143-.74-.348-.348-.561-.679-.74-1.143-.136-.35-.297-.876-.342-1.848-.045-.983-.054-1.281-.054-3.776s.01-2.793.054-3.776c.045-.972.206-1.498.342-1.848.179-.464.392-.795.74-1.143.348-.348.679-.561 1.143-.74.35-.136.876-.297 1.848-.342.983-.045 1.281-.054 3.776-.054z"></path>
            </svg>
          </a>
        </div>
      </div>
    </div>
    <p style="text-align:center;margin-top:2rem;padding-top:2rem;border-top:1px solid rgba(255,255,255,0.2);">
      © 2025 Майчинство BG. Всички права запазени.
    </p>
  </div>
</footer>


  <!-- Desktop sticky footer ad (consent-aware, closeable) -->
  <div id="sticky-ad" class="sticky-ad" aria-hidden="true" hidden>
    <button type="button" class="sticky-close" aria-label="Затвори">×</button>
    <ins class="adsbygoogle" style="display:block" data-ad-client=""  data-ad-format="auto" data-full-width-responsive="false"></ins>
  </div>

  <script>

  <script src="/scripts/site.js" defer></script>
    // Performance: lazy-load images and async decode where missing
    (function(){
      const imgs = document.querySelectorAll('img');
      imgs.forEach(img => {
        const isLogo = img.classList.contains('logo-image');
        if (!img.hasAttribute('loading') && !isLogo) {
          img.setAttribute('loading', 'lazy');
        }
        if (!img.hasAttribute('decoding')) {
          img.setAttribute('decoding', 'async');
        }
        // Add background-color placeholder while loading
        if (!img.style.backgroundColor) {
          img.style.backgroundColor = '#f3f4f6';
        }
      });
      
      // Prefetch images that are immediately visible (hero images)
      const heroImages = document.querySelectorAll('.hero-image');
      heroImages.forEach(img => {
        if (img.complete) {
          img.style.backgroundColor = '';
        } else {
          img.onload = () => img.style.backgroundColor = '';
        }
      });
    })();
  </script>

  <script>
    // Accessible dropdown menus: click/keyboard support
    (function(){
      const nav = document.querySelector('.main-nav');
      if (!nav) return;
      const dropdownParents = nav.querySelectorAll('.nav-item.has-dropdown');
      dropdownParents.forEach(parent => {
        const trigger = parent.querySelector('.nav-link');
        const menu = parent.querySelector('.dropdown');
        if (!trigger || !menu) return;
        // Open on click (toggle)
        trigger.addEventListener('click', function(e){
          e.preventDefault();
          const expanded = trigger.getAttribute('aria-expanded') === 'true';
          // Close others
          dropdownParents.forEach(p => {
            const t = p.querySelector('.nav-link');
            const m = p.querySelector('.dropdown');
            if (p !== parent) {
              t && t.setAttribute('aria-expanded','false');
              m && m.classList.remove('open');
            }
          });
          trigger.setAttribute('aria-expanded', expanded ? 'false' : 'true');
          menu.classList.toggle('open');
        });
        // Keyboard: Enter/Space to open, Escape to close
        trigger.addEventListener('keydown', function(e){
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            trigger.click();
          } else if (e.key === 'Escape') {
            trigger.setAttribute('aria-expanded','false');
            menu.classList.remove('open');
            trigger.blur();
          }
        });
      });
      // Close when clicking outside
      document.addEventListener('click', function(e){
        if (!e.target.closest('.has-dropdown')) {
          dropdownParents.forEach(parent => {
            const t = parent.querySelector('.nav-link');
            const m = parent.querySelector('.dropdown');
            t && t.setAttribute('aria-expanded','false');
            m && m.classList.remove('open');
          });
        }
      });
    })();
  </script>

  <style>
    /* Open state for dropdown via JS */
    .has-dropdown .dropdown.open {
      opacity: 1 !important;
      visibility: visible !important;
      transform: translateY(0) !important;
      z-index: 10050;
    }
  </style>

  <!-- Search functionality is now handled by /scripts/search.js -->
  <script src="/scripts/search.js" defer></script>

  <!-- Analytics & Performance Monitoring -->
  <script>
    // Track page performance metrics
    if (window.performance && window.performance.timing) {
      window.addEventListener('load', function() {
        setTimeout(function() {
          const timing = window.performance.timing;
          const pageLoadTime = timing.loadEventEnd - timing.navigationStart;
          const connectTime = timing.responseEnd - timing.requestStart;
          const renderTime = timing.domInteractive - timing.navigationStart;
          
          // Log metrics (integrate with your analytics service)
          if (window.gtag) {
            gtag('event', 'page_load_time', {
              'value': pageLoadTime,
              'event_category': 'performance'
            });
          }
        }, 0);
      });
    }

    // Track outbound links
    document.addEventListener('click', function(e) {
      const target = e.target.closest('a');
      if (target && target.href && target.href.startsWith('http') && !target.href.includes('motherhood.bg')) {
        if (window.gtag) {
          gtag('event', 'outbound_link', {
            'destination': target.href,
            'event_category': 'engagement'
          });
        }
      }
    });
  </script>

</body>
</html>
